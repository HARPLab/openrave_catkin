find_package(OpenRAVE REQUIRED)

set(OpenRAVE_DEVEL_DIR "${CATKIN_DEVEL_PREFIX}/${CATKIN_GLOBAL_SHARE_DESTINATION}/openrave-${OpenRAVE_LIBRARY_SUFFIX}")
set(OpenRAVE_INSTALL_DIR "${CATKIN_DEVEL_PREFIX}/${CATKIN_GLOBAL_SHARE_DESTINATION}/openrave-${OpenRAVE_LIBRARY_SUFFIX}")
set(OpenRAVE_DATA_DIR "data")
set(OpenRAVE_PLUGINS_DIR "plugins")
set(OpenRAVE_DATABASES_DIR "databases")

macro (openrave_plugin target_name)
    add_library("${target_name}" SHARED ${ARGN})
    target_link_libraries("${target_name}" ${OpenRAVE_LIBRARIES})
    set_target_properties("${target_name}" PROPERTIES
        PREFIX ""
        COMPILE_FLAGS "${OpenRAVE_CXX_FLAGS}"
        LINK_FLAGS "${OpenRAVE_LINK_FLAGS}"
        LIBRARY_OUTPUT_DIR "${OpenRAVE_DEVEL_DIR}/${OpenRAVE_PLUGINS_DIR}"
    )
    message(STATUS "Writing plugin to ${OpenRAVE_DEVEL_DIR}/${OpenRAVE_PLUGINS_DIR}")

    install(TARGETS "${target_name}"
        ARCHIVE DESTINATION "${OpenRAVE_INSTALL_DIR}/${OpenRAVE_PLUGINS_DIR}"
        LIBRARY DESTINATION "${OpenRAVE_INSTALL_DIR}/${OpenRAVE_PLUGINS_DIR}"
        RUNTIME DESTINATION "${OpenRAVE_INSTALL_DIR}/${OpenRAVE_PLUGINS_DIR}"
    )
endmacro ()
